# DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN

function %TODO%() {
  security_tool="%TODO%"
  action="%TODO%"
  security_tool_upper=$(echo "${security_tool}" | tr '[:lower:]' '[:upper:]')
  security_tool_argument="--skip-${security_tool}"
  security_tool_env_var="SKIP_${security_tool_upper}"

  if [[ "${1}" == "${security_tool}" ]]; then
    _feedback WARNING "Skipping ${security_tool} due to ${security_tool} argument"
    shift
  elif [[ "${!security_tool_env_var:-false}" == "true" ]]; then
    _feedback WARNING "Skipping ${security_tool} due to the ${security_tool_env_var} environment variable value"
  elif [[ -r "/${security_tool}_complete" ]]; then
    _feedback INFO "Skipping ${security_tool} because it was already run on $(date -d @$(cat /${security_tool}_complete))"
  else
    ${security_tool} / || process_security_tool_exit_status "${?}" "${security_tool}" "${action}"
  fi

  # Run the command per a PATH lookup, after any easy_infra specific arguments are removed
  command "${FUNCNAME[0]}" "$@"
}

